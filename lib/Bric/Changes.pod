=head1 NAME

Bric::Changes - Bricolage Changes

=head1 VERSION

$Revision$

=head1 DATE

$Date$

=head1 DESCRIPTION

This document lists the Changes to Bricolage introduced with each release.

=head1 VERSION 1.5.1

=head2 New Features

=over 4

=item *

Lots of group-related optimizations. These should greatly improve the speed
with which permissions are checked. [David]

=item *

Improved testing support with lots more tests. Many more remain to be
written. See the new testing documentation in L<Bric::Hacker|Bric::Hacker> for
details. [David]

=item *

Added ability to publish assets at a future time to Bric::SOAP::Workflow.
Includes addition of new C<--publish-date> option to F<bric_soap>. [David]

=item *

A number of default groups where not properly added to the "All Groups"
group. Now they are. [David]

=item *

Added WebDAV mover. [JoE<atilde>o Pedro]

=item *

Fixed the description of the root category in the permissions profile for user
groups so that it properly displays its URI instead of its name. This only
affects the display of the root category in the permisisons profile for people
who installed (rather than upgraded to) Bricolage 1.4.5 or later. [David]

=item *

FTP and File System movers now atomically copy files to their destination
servers. [JoE<atilde>o Pedro]

=item *

Added "All Desks" group for managing the permission to access all desks.
[David]

=item *

Refactored and optimized the code used in the C<lookup()>, C<list()>,
C<list_ids()>, and, where pertinent, C<href()> methods in the following
classes:

=over 4

=item Bric::Biz::AssetType

=item Bric::Biz::ATType

=item Bric::Biz::Category

=item Bric::Biz::Org

=item Bric::Biz::Org::Person

=item Bric::Biz::Org::Source

=item Bric::Biz::OutputChannel

=item Bric::Biz::OutputChannel::Element

=item Bric::Biz::Person

=item Bric::Biz::Person::User

=item Bric::Biz::Workflow

=item Bric::Biz::Workflow::Parts::Desk

=item Bric::Dist::Job

=item Bric::Dist::ServerType

=item Bric::Util::AlertType

=item Bric::Util::Event

=item Bric::Util::Grp

=item Bric::Util::Pref

=back

This work will allow permission checking to be much faster for objects of
these classes, as the relevant group IDs are now looked up for each object
when the object is looked up, rather than by a separate select for each
object, one-at-a-time. The changes also include support for a C<grp_id>
parameter to be passed to the C<list()> method of these classes as a way of
allowing a group to return a list of the objects in the group en masse, rather
than one-at-a-time from the member objects of each group. Once similar
optimizations have been made to the Bric::Biz::Assest classes, the necessary
change will be made to Bric::Util::Grp to allow this functionality. [David]

=item *

Added object caching to the base class, and calls to it from all classes with
a C<lookup()> method to take advantage of it. The caching is only for the
duration of a request for now, but can be expanded later. [David]

=item *

Updated F<INSTALL.MacOSX> to reflect changes thanks to the new Mac OS X suport
included in libapreq 1.1. [David]

=back

=head2 Bug Fixes

=over

=item *

The publish attribute of desks can now be unset. Thanks to Sean Greathouse for
the catch! [David]

=item *

Fixed asset class date parameters to list(). The asset classes were neglecting
to change the dates pased in to list() to database dates before querying the
database. This lead to the wrong stories being returned for everyone not using
UTC as their local time zone. Thanks to Bill Cappel for the spot! [David]

=back

=head1 VERSION 1.5.0

=head2 New Features

=over 4

=item *

Added unit testing framework based on L<Test::Class|Test::Class> and executed
by L<Test::Harness|Test::Harness>. Tests can be run after C<make install> by
running C<make test> or C<make devtest>. The former runs tests that access
database data but execute no C<INSERT>, C<UPDATE>, or C<DELETE> commands. The
latter runs tests that can make changes to the database, and are intended to be
a full testing of Bricolage's API. Both make targets can be executed in
verbose mode by passing C<TEST_VERBOSE=1> to the make command. From now on,
all tests will be expected to pass before changes are committed to the
repository. [David]

=item *

Added F<Makefile.PL>. This is mainly a dummy script designed to mimic the
usual way in which Perl modules are installed. It doesn't actually create a
F<Makefile>, but processes the existing one, setting it up to use whatever
Perl was used to execute F<Makefile.PL> itself. The advantage to this is that
the Perl that executes F<Makefile.PL> will be used throughout Bricolage. [David]

=item *

Migrated tests in F<lib/Bric/Util/Grp.pl> to F<t/lib/Bric/Util/Grp/Test.pm>
and F<t/lib/Bric/Util/Grp/DevTest.pm>. [David]

=item *

Added F<t/Bric/Test/PodTest.pm>, which uses L<Pod::Checker|Pod::Checker> to
examine the POD in all the Bricolage modules, scripts, and test modules and
report errors. Currently, all the errors are "TODO" tests, which means that,
technically, they'll pass. But as soon as all existing POD errors are cleaned
out, errors will turn into test failures. This will help us to keep all of our
POD valid. These tests run as a part of C<make devtest>. [David]

=item *

Removed all old-style test scripts. Their contents have been copied into new
unit testing classes. These classes each execute a single test, and the old
testing contents are at the end of the file, after the C<__END__> symbol. Thus
we'll be able to use the old tests to write the new tests. [David]

=item *

Added documentation on merging CVS branches to
L<Bric::Hacker|Bric::Hacker>. [David]

=item *

Removed the URI Format and URI Case preferences and put them into Output
Channel objects, instead. They are now output channel-specific. [David]

=item *

URI format and URI case settings now properly format the URIs of media
objects, too. [David]

=item *

The slug can now be used in the Fixed URI Format. [David]

=item *

The slug can now be used for story file names. The option is supported on an
output channel basis, and will only work for stories that have a slug. [David]

=item *

Added a "and Shelve" option to the "Check In" select list in the button bar on
story, media, and asset pages. When this option is selected, the asset is
checked in and then removed from workflow without publishing. [David]

=item *

Removed the "Checkin/Publish" and "Checkin/Deploy" buttons in asset profiles
and replaced them with new "and Publish" or "and Deploy" options in the "Check
In" select list in the button bar. Doing this collects all the usual Check In
actions in one place and saves us screen real estate! [David]

=item *

Changed the way the "Checkin and Publish" and "Checkin and Deploy" callbacks
work to use existing code in the desk and publish widgets to do the dirty
work. This greatly reduces code duplication. [David]

=item *

Created a new class,
L<Bric::Biz::OutputChannel::Element|Bric::Biz::OutputChannel::Element>, which
is a subclass of L<Bric::Biz::OutputChannel|Bric::Biz::OutputChannel>. This
new class better manages the mapping of output channels to elements than the
old approach did. It also adds a new property, C<enabled>, which will be put
to use shortly. [David]

=item *

Replaced all the custom handling of output channel objects in
L<Bric::Biz::AssetType|Bric::Biz::AssetType> with a new
L<Bric::Util::Coll|Bric::Util::Coll> subclass that does it all. This is a lot
more efficient in terms of programmer time (and probably performance,
too). [David]

=item *

Modified Bric::Biz::Asset::Business to manage the association between business
assets and output channels by making use of the
Bric::Util::Coll::OutputChannel class. It also automatically adds all of the
"enabled" output channels of the element object as initial output channel
associations for new business assets. [David]

=item *

Adds a new property to templates: template types. This property can have one
of three value that correspond to different template types: "Element
Templates" (those associated with elements); Category Templates" (autohandlers
in Mason parlance, category templates to HTML::Template users, and until now
"generic templates" in the UI); and "Utility Templates" (those not associated
with anything, but can be used as includes). [David]

=item *

Templates are now guaranteed to have unique file name/output channel
combintations at the API and database levels. [David]

=item *

For stories on My Workspace, Replaced "Trail" with "Clone". Clicking this link
will make an exact copy of the story with the words "Clone of " prepended to
the story title. [David]

=item *

Got rid of the popup window. Now when the toolbar-less window isn't the
current window, the browser will be redirected to a a Welcome page where users
can click a link to open the new window with the Bricolage UI. [David]

=item *

Improved the interface for the assocation of output channels in Element
Profile. It now uses a list of output channels rather than a double list, and
a radio button to select the primary output channel. Also, each associated
output channel can be marked as "Enabled" or not, indicating whether a new
asset based on the element will by default be associated with that output
channel for publishing. [David]

=item *

On a related note, Stories and Media can now select which output channels to
be published to on a per-story basis as well as which is the primary output
channel, and the selection sticks with each version of a an asset. The list of
available output channels comes from the output channels associated with the
element on which the story or media asset is based. [David]

=item *

Bric::Util::Burner objects have a new property, C<mode>. This property
contains an integer value indicating whether a burner object is currently
publishing, previewing, or checking syntax. The value maps to the
conveniently-named constants "PUBLISH_MODE", "PREVIEW_MODE", and
"SYNTAX_MODE". [David]

=item *

The documentation in the Bric::Util::Burner class has been updated and
improved. [David]

=item *

Arguments can now be passed to the C<display_pages()>, C<display_element()>,
and C<chain_next()> methods of the C<$burner> object in Mason templates. These
arguments are passed to the templates that are executed just as they are if
you'd called C<< $m->comp >>, meaning that you can access their values via the
C<%ARGS> global and in C<< <%args> >> blocks in Mason templates. [David]

=item *

Changed the C<display_pages()> method of Bric::Util::Burner::Mason so that its
first argument can be an anonymous array of the names of different paginated
elements, and then all of those different paginated elements will be burned in
order. This allows a story to have more than one type of paginated
element. [David]

=item *

Added the methods C<prev_page_file()>, C<prev_page_uri()>,
C<next_page_file()>, and C<next_page_uri()> to Bric::Util::Burner. These
methods return the strings representing the file names or URIs of the previous
and next pages of a stsory, relative to the page that is currently being
burned and, in the case of the C<*_uri()> methods, appropriate to the
currently-burning Output Channel. Also updated the
L<Bric::Templates|Bric::Templates> and
L<Bric::AdvTemplates|Bric::AdvTemplates> documents to reflect these
additions. [David]

=item *

Added C<source__id> to list of criteria by which stories can be searched via
the Bric::Biz::Asset::Business::Story C<list()> and C<list_ids()>
methods. [David]

=item *

The Bricolage CSS document is now a static file served by Apache rather than a
Mason component processed by mod_perl. This allows the style sheet to be
cached by the browser so that it doesn't have to request it for every page in
Bricolage. It also cuts down on procesing time, since it doesn't have to be
managed dynamically as a Mason component anymore. Also, all font sizes are now
specified in pixels instead of points, in order to maximize the consistency of
cross-browser font rendering. [David]

=item *

Added a new style for the template profile, so that template code is now
displayed in its textarea box in a monospaced font. [David]

=item *

The main Bricolage JavaScript library has had several other JavaScript
libraries rolled into it, and is now a static file served by Apache rather
than a Mason component processed by mod_perl. This allows the JS to be cached
by the browser so that it doesn't have to request it for every page in
Bricolage. It also cuts down on procesing time, since it doesn't have to be
managed dynamically as a Mason component anymore. [David]

=item *

Added F<bricolage.conf> directive "ALLOW_WORKFLOW_TRANSFER" to allow assets on
shared desks to be able to be transferred across workflows via that shared
desk. [David]

=item *

Changed Bric::Util::Burner to set C<publish_status> after publishing, rather
than before. Thus it is only set if the publish is successful, while at the
same time templates can check C<publish_status> to determine if a story is
being published for the first time. [David]

=item *

Added C<get_more_pages()> method to Bric::Util::Burner::Mason. It returns true
if more pages remain to be burned, and false if not. However it's only
enumerated when C<display_pages()> is being used to output pages. [David]

=item *

Optimized Bric::Biz::Category to get a list of Group IDs for each category as
it is selected from the database. This prevents the C<get_grp_ids()> method
from having to query the database, which was happening for every category
object for which permissions are checked. [Mark & David]

=item *

Added event logging for keywords. [David]

=item *

Changed the code in Bric::Util::Burner::Mason to allow for new Mason burners
to be constructed and used to publish stories from within templates. This is
useful for generating tables of contents and such. [David]

=item *

Added support for the association between business assets and output channels
to the SOAP interface. [David]

=item *

Removed IO::String dependence. [Scott]

=item *

Added a FAQ. [Scott]

=item *

Added a preference for naming the Bricolage instance. [Scott]

=item *

Added search by Category URI to Find Stories. Although one could use the
search by URI feature for this before, it didn't allow for search by secondary
categories. Now stories can be searhed for in both primary and secondary
categories. [David]

=item *

Added the methods C<page_file()> and C<page_uri()> to Bric::Util::Burner. When
passed a page number argument, these methods return the strings representing
the file names or URIs of the given page in the curently-burning story and, in
the case of the C<page_uri()> method, appropriate to the currently-burning
Output Channel. These methods are best used in burners that don't burn one
page at a time, such as Burner::Template. [David]

=item *

Ported to HTML::Mason versions 1.15 and higher. [Scott]

=item *

Added C<make uninstall> support to installation system. [Scott]

=item *

Added C<page_filepath()> method to Bric::Util::Burner. This method allows
burner subclasses to get the name of a file to write to the file system
without needing to figure out the file name themselves. [David]

=item *

Optimized behavior of collections (internal API). Now when an object is
deleted from a collection (for example, when a member is deleted from a
group), all the existing objects in the collection won't first be looked up in
the database. The upshot is that certain parts of Bricolage that rely on
collections, such as desks, should be more responsive. [David]

=back

=head1 VERSION 1.4.6

=head2 Bug Fixes

=over 4

=item *

Bric::SAOP::Handler now properly logs fatal errors that are strings rather than
exceptions. [David]

=item *

Updated Bric::DBA documentation to better reflect PostgreSQL standards.
[Neil Conway]

=item *

Minor documentation correction in Bric::Util::Grp::Parts::Member. [Mark]

=item *

Fixed bug in SOAP interface where container subelements added to a story or
media asset were logged as if the story type element or media type element was
added instead of the appropriate subelement. [David]

=item *

Fixed bug in publish code that was attempting to use the Apache request object
as a media asset. Thanks to John Greene for the spot. [David]

=item *

Fixed bug where an empty or non-numeric <size> element in an imported
media object would cause an SQL error. [Sam]

=item *

The F<bric_apachectl>, F<bric_clean_tmp>, F<bric_dist_mon>, and F<bric_ftpd>
scripts are now smarter about loading Bricolage libraries and reporting
relevant errors when they can't load Bricoalge libraries. Thanks to Geoff
Richards for the patch. [David]

=item *

Category permissions are now properly checked on assets when they're not in
workflow as well as when they are in workflow. This means that if a group of
users is granted permission to access stories in a category, they can now
access those stories even if they're not in workflow. [David]

=item *

The search interface for locating media and story assets to relate to a story
now checks the permissions of the assets found and only displays the assets
for which the user has at least READ permission. Thanks to Sean Greathouse for
the spot. [David]

=item *

Reverting a media asset now properly reverts the media file itself, as well.
[David]

=item *

The "Last" field is now properly highlighted as the default order field when
displaying a list of contributors in the Contributor Manager. [David]

=item *

Contributor Association now includes search options and only
currently-associated contributors are displayed before searching. [David]

=item *

The ability to select different fields by which to sort a list of objects now
works again. [David]

=item *

The installer now checks to make sure that mod_perl is statically compiled
into Apache, since weird things tend to happen when Bricolage uses a DSO
mod_perl. [David]

=item *

Fixed reordering code for subelements. The select list for subelements should
now always have an appropriate value. [David]

=item *

The URI is now properly updated in media assets when some part of the URI is
changed in the UI. Thanks to Sean Greathouse for the spot. [David]

=item *

The Add More widget no longer throws an exception when "Add More" is clicked
and only one field currently exists. This had affected Keywords entry in
stories. Thanks to Sam for the spot. [David]

=item *

Fixed bug where a user could create two assets with the same URI as long as
they were both checked out by that user. Thanks to Shannon Brown for the spot!
[David]

=item *

Date fields can now be unset. That is, if each of the select fields is set to
its label, rather than a value, it'll stay that way. This was first noticed
with the "Expire Date" in stories. Thanks to Philip Fibiger for the spot.
[David]

=item *

Modified installation C<CREATE DATABASE> command to always create the database
with the encoding set to UTF-8 (UNICODE). [David]

=item *

Added instructions for installing readline library to README.MacOSX. [David]

=item *

Fixed some inaccurate image sizes. [Geoff Richards]

=item *

Added missing C<uri> parameter to the possible search options in
C<< Bric::SOAP::Category->list_ids >>. [David]

=back

=head1 VERSION 1.4.5

=head2 Changes

=over 4

=item *

Categories are now displayed by their URIs instead of their names wherever
possible. [David]

=item *

Added "Order" and "OrderDirection" parameters to C<< Bric::Util::Grp->list >>
in order to be able to specify a different column and sort order for getting a
list of groups. [David]

=item *

Improved error handling by the SOAP server. Full errors will now be printed to
the Apache error log, error messages sent back to the client are properly
escaped, and all database transactions for a single request will be rolled
back in the event of an error. [David]

=back

=head2 Bug Fixes

=over 4

=item *

Fixed error message generated from Bric::SOAP::Template->update() to
properly display the category name, rather than "ARRAY(0x9cf43bc)". [Sam]

=item *

The Bricolage SOAP interface will no longer allow the creation of
stories and media with duplicate URIs. [Sam]

=item *

Fixed circular dependency issues when Bricolage modules are used in the
C<PERL_LOADER> F<bricolage.conf> directive. [David]

=item *

Added the root category to the "All Categories" group. It should have been in
that group all along. [David]

=item *

Documentation for C<< Bric::Biz::Workflow->list >> has been improved, and the
method used for finding workflows and desks to put imported assets on in
Bric::SOAP has been simplified. [David]

=item *

Added printing of a message regarding the filenames being processed by
F<bric_soap>'s C<create> and C<update> commands when its C<--verbose> option
is set. [David]

=item *

Setting a story's cover date to a date that causes one of its URIs to conflict
with an existing story's URIs no longer causes an error. Thanks to Sam for the
spot! [David]

=item *

Display of the source was missing from the view Story and Media profiles, but
no longer. [David]

=item *

The correct source is now displayed in the Story and Media edit profiles.
[David]

=item *

An attempt to install Bricolage to use an existing PostgreSQL user no longer
causes an installation error when you decline drop the user. [David]

=item *

The burner no longer fails when it publishes an asset that's not on a
desk. [David]

=item *

SOAP now does the proper thing when deleting assets, removing them from desks
and workflow only if they're on desks and in workflow. [David]

=item *

Added support for the missing C<publish_status> parameter to
C<< Bric::Biz::Asset::Business::Media->list >>. [David]

=item *

Setting permissions on the assets in a category works again. [David]

=item *

Fixed a bug where exporting a story via SOAP containing a date field
would output the formatted date rather than the expected ISO 8601
format.  Systems with a modified date format pref would then refuse to
accept the story on import, producing an "Unable to unpack date"
error. [Sam]

=item *

Stories, media, and templates created but not saved no longer disappear into
the void. They are instead moved into workflow, put on a desk, and saved as
soon as they were created. [David]

=item *

Permissions are now properly checked for category and workflow settings when
new stories, media, and tempmlate assets are created. [David]

=item *

New templates are now active by default. [David]

=item *

Fixed bug where the "Checkin/Publish" (and "Checkin/Deploy") button wasn't
provided to users who had EDIT access to a the assets on a desk. Permissions
are now properly checked and the button displayed for those who can publish
from a desk. [David]

=item *

Added missing debugging statement to Bric::Util::DBI. Thanks to Mark for the
spot. [David]

=item *

The SOAP interface now properly logs events for its activities. [David]

=item *

Previewing a story while searching for a related story to link to an element
no longer replaces the Bricolage UI with the preview, as was happening with
some browsers. Instead, a separate preview window is opened. [David]

=item *

When publishing a media asset, its name will not be properly added to the UI
message, without causing an error. [Petar Bojkov]

=item *

Fixed exception class name in Handler.pm. [Scott]

=item *

Fixed installation system bug caused by inst/conf.pl loading
Bric::Config during "make install".  Thanks to Louis Moore for the
report. [Sam]

=item *

Added missing C<list_ids()> method to Bric::Biz::Category. [David]

=back



=head2 Bug Fixes

=over 4

=item *

Empty listManager lists no longer have a gap in them. [David]

=item *

Made the table around the formBuilder radio buttons prettier. [David]

=item *

Fixed numbering of sections in Media profile so that the numbers don't
skip. [David]

=item *

Updated display of existing contributors in the "Edit Contributors" screen of
the story and media asset profiles to use listManager. This makes them look
like they do everywhere else (and uses less code, to boot!). [David]

=item *

Improved error messages thrown in exceptions in Bric::Util::Trans::FTP.
[David]

=item *

Removed code and documentation for PostgreSQL 7.3 compatability. With the
release of 7.3b2, it's no longer needed. [David]

=item *

Fixed "make clone" to properly include database contents in clone
distribution. [Sam]

=item *

Added C<< <meta http-equiv="Content-Type"> >> tag to the C<< <head> >> to
F<header.mc> so that the browser knows to send text back to Bricolage in the
expected character set. [Mark]

=item *

Changed the default character set from ISO-8859-1 to UTF-8. With this setting,
Bricolage does no character set translation, so it's faster. Furthermore, most
users I<should> be outputting UTF-8 in their templates, anyway. If you're not,
then you're likely finding doing charset translation in all of your templates
to be a big PITA. And if you're not doing charset translation, then you really
I<are> outputting UTF-8 in your templates, and just haven't realized it.
[David]

=item *

Fixed bug when reverting stories and media with no associated contributors.
[Mark]

=item *

"Check In and Publish" now works again for Media assets. Thanks to Matt Vella
for the spot. [David]

=item *

Deleting assets on My Workspace now prompts the user to make sure s/he really
wants to do that. Not sure how we missed this all this time! Thanks to Andrew
Baio for the spot. [David]

=item *

Assets on Desks and My Workspace that are checked out to the the user whose
viewing them will now always preview the version as currently edited by the
user, rather than the last checked-in version. Other users still can only
previewe the last checked-in version. [David]

=item *

Clicking the "Check In" or "Check In/Deploy" buttons in a template profile now
properly updates the template with any new data entered into the template
profile before attempting a syntax check. This ensures that the latest data
you've entered gets its syntax checked before the template is checked in or
deployed. [David]

=item *

Fixed a bug in Bric::Util::Class where classesn't couldn't be looked up by
package name. This affected the "Access Denied" page. [David]

=item *

Made Bric::Util::Burner::Mason a little smarter handling exceptions. [David]

=item *

Fixed bug where Bric::SOAP::Category would fail to import ad strings. [David]

=item *

Fixed bug in C<< Bric::Util::Grp->has_member >> where an already-added member
wasn't always found. [Mark]

=item *

Conflicting URI messages for media assets no longer suggest changing the value
of the slug, since media assets have no slug. [David]

=item *

The friendly messages confirming publishes are back. [David]

=item *

Fixed bug where selecting a large number of list options in the story profile
would cause an SQL error. [Matt]

=item *

Fixed bug where Bric::SOAP would accept story element types for media and vice
versa. Thanks to Evan Prodromou for the spot. [Sam]

=item *

Added code to installation scripts to delete existing Mason object files when
upgrading. This hasn't been a problem thus far, but this step will help to
ensure that users are always running the latest UI components. [David]

=item *

Fixed bug where deactivated element types weren't checked before creating a
new element type with the same name as a deactivated element type. Thanks to
Geoff Richards for the spot. [David]

=back

=head1 VERSION 1.4.3

=head2 Bug Fixes

=over 4

=item *

Fixed inconsistencey between container element methods and their convenience
accessors in Bric::Biz::Asset::Business. Thanks to Philip Fibiger for the
spot. [David]

=item *

Assets can once again be recalled from the library and put on a desk. [David]

=item *

The C<get_all_keywords()> method of Bric::Biz::Asset::Business works
again. [David]

=back

=head1 VERSION 1.4.2

=head2 Bug Fixes

=over 4

=item *

Can once again check out multiple assets at once. Thanks to Andrew Baio for
the spot. [David]

=item *

Templates once again behave themselves. There were some circumstances where
they couldn't be checked in, generating "Cannot checkin non checked out
versions" errors. These have been fixed. [David]

=item *

Some assets on My Workspace were getting "Cannot checkin non checked out
versions" errors when they were checked in using the "Check in to" select
list. This has been fixed. [David]

=item *

When templates are deployed, they now get a "Template removed from Workflow"
event logged. [David]

=item *

Using the "Check in to" select list on My Workspace to check assets into the
desk they're already on will no longer remove them from all desks
altogether. [David]

=back

=head1 VERSION 1.4.1

=head2 Bug Fixes

=over 4

=item *

Upgrading from from a version prior to 1.3.3 no longer tries to create an
index that already exists (and that will be dropped, anyway). [David]

=item *

Removed documentation for intalling mod_proxy with Apache. [David]

=item *

Improved documentation for upgrading from older versions of Bricolage that
were not installed by C<make install>. Thanks to Andrew Baio for helping to
identify the problems. [David]

=item *

Added C<use Bric::Util::Grp::Keyword;> back into Bric::Biz::Keyword. This
prevents some upgraded Bricolage installations from breaking. [David]

=item *

Added Net::FTPServer and Net::SFTP to the list of optional modules. [David]

=item *

Fixed some SQL errors uncovered by the release of PostgreSQL 7.3b1. [David]

=item *

Added code and documentation for compatability with PostgreSQL 7.3. [David]

=item *

Media assets can now be distributed to more than one output channel at a
time. [David]

=item *

Files are now distributed on a per-output channel basis, to ensure that the
proper file is distributed to the proper destinations. [David]

=item *

Assets are now properly removed from workflow when they're deactivated
(deleted in the UI). [David]

=item *

Template syntax is now properly checked when using the "Checkin/Deploy"
button. [JoE<atilde>o Pedro]

=item *

The example generic template (autohandler) included in the database is now
included in the burn root, too, since it's marked as "Deployed" in the
database. [David]

=item *

Deleted output channels no longer show up in the "New Template" output channel
select list. Thanks to Daniel Fisher for the spot. [David]

=item *

The root category ("/") no longer returns itself as its own parent. [David]

=item *

Assets not in workflow are now properly logged as being checked out when
someone checks them out. [David]

=item *

The "Or Pick a Type" menus in the Group manager, the Contributor manager, and
the Element manager all work again. [David]

=item *

Changing category names now updates the name of the category asset group
object, which appears in the user group permissions page. [David]

=item *

Hitting the "enter" key after filling in a serach field now properly submits
the search as if the "Search" button had been clicked. [David]

=item *

Changed libapreq requirement in Bric::Admin to read "Apache::Request
1.0". This should make the installer install the most recent version of
libapreq, instead of relying on whatever the OS provides. [David]

=item *

Changed value of autopopulated media asset data fields to an empty string when
the value returned by the autopopulation method is C<undef>. [David]

=item *

Fixed bug where autopopulated media asset data fields weren't properly
autopopulated. [David]

=item *

Fixed problem with category upgrade script failing on category data
created with 1.3.2. [Sam]

=item *

During installation, entering a directory name when prompted for the "PID File
Location" now results in Bricolage using a file called "httpd.pid" in that
directory, rather than trying (and failing) to use the directory itself as the
PID file. [David]

=item *

The side navigation layer is now better aware of its context, and changes the
colors of some of its graphics depending on the context. Also recreaed the
"WORKFLOW" tab graphics. It looks like this has been broken for over a year,
and I only just noticed it! [David]

=item *

Slightly improved handling of assets that have forgotten where they
are. [David]

=item *

Checked-out templates are now displayed only once (instead of twice) in the
"Find Templates" manager. [David]

=item *

Added C<get_new_objs()> method to Bric::Util::Coll so that Bric::Util::Grp's
C<has_member()> method can see a member even if it hasn't been saved to the
database. Also changed Bric::Util::Grp to check for members in this way, of
course. [David]

=item *

Assets retrieved from the library now appear on the desk they're checked out
into only once (instead of twice). This thanks to the above-noted changes to
Bric::Util::Grp. [David]

=item *

Added upgrade script F<inst/upgrade/1.4.1/clean_desks.pl> to clean up existing
duplicate listings of assets on desks. [David]

=item *

Removed the C<checkin()> method from Bric::Biz::Asset::Formatting and
Bric::Biz::Asset::Business and put it into Bric::Biz::Asset, instead, since
it's exactly the same for all assets. [David]

=item *

Fixed the display of permissions settings to be more consistent with the
design and layout of the rest of the application. Also neatened listManager
display a bit. [David]

=item *

Fixed misnamed database constraint. [David]

=item *

Templates can once again be retreived from the library and checked out for
revising. [David]

=item *

Assets on a desk now no longer have the current desk listed in the "Move to"
select list. Even if they did, selecting the current desk would no longer
remove an asset from workflow! Thanks to Andrew Baio for the spot. [David]

=item *

The installer is now much more intelligent about prompting for SSL
information. It won't ask if you want to use SSL if it can't find mod_ssl or
apache_ssl, and will only prompt you to pick one or the other if it can find
both. [David]

=back

=head1 VERSION 1.4.0

=head2 New Features

=over 4

=item *

Fetching objects from Bric::Biz::Asset::Business::Media has been optimized for
greater speed. [JoE<atilde>o Pedro]

=item *

PostgreSQL "NOTICE" messages are now suppressed during installation. Instead,
a series of dots will be displayed to indicate progress loading the
database. [David]

=item *

Added README.MacOSX. [David]

=item *

You can now pass a date format string argument to the C<get_data()> method of
container elements in templates (and elsewhere, for that matter). This is
useful if the data you're retrieving is of the "date" type, and you don't want
the date to be formatted in the format specified in the "Date Format"
preference. [David]

=back

=head2 Bug Fixes

=over 4

=item *

The Element Type manager now displays properly again without errors. [David]

=item *

Assets are now properly removed from desks when they are published or moved
from one desk to another. More generally, any time a single object is removed
from a group, it will be properly removed. [David]

=item *

Media profile now display the proper category in the Category select
list. [David]

=item *

Media assets with no associated media file now generate a message indicating
that no file will be distributed, and are properly removed from workflow when
published. [David]

=item *

Some media asset events weren't getting logged properly Now they are. [David]

=item *

Database transactions are now properly maintained when publishing
assets. Everything was working, but DBI C<AutoCommit> was getting turned on,
and this likely slowed some things down a bit. [David]

=item *

Assets can once again be found via the "Find" pages and recalled into a
workflow without error. [David]

=item *

Module man pages are now properly installed under Perl 5.8.0. Thanks to
Michael Schwern for helping to diagnose the problem and come up with a
solution. [David]

=item *

The select list of desks to transfer an asset to on My Workspace now includes
all possible desks, including the one for which there is a link. [JoE<atilde>o
Pedro]

=item *

All Bricolage F<.pod> files are now installed and converted to C<man> pages
along with all of the F<.pm> files. [David]

=item *

Corrected a bunch of spelling errors in this file. [David]

=item *

Calling C<get_data()> on a container element in templates (or elsewhere, for
that matter) now properly ignores container subelements. Likewise for
C<get_container()>, whicn how properly ignores data subelements. [David]

=item *

All of the F<.pl> and F<.tst> files in F<lib/> no longer clutter up the
distribution created by C<make dist>. [David]

=item *

Much of the POD documentation in the API classes has been cleaned up, and
converting them to man pages no longer generates any error messages. [David]

=item *

The install process will now find Apache modules in
/usr/lib/apache/modules, which is where they are in OpenBSD. Thanks to
Mark Johnson for his help tracking this one down.  [Sam]

=item *

The install process will no longer install an incompatible version of
HTML::Mason (>1.09). [Sam]

=item *

The F<bric_dist_mon> program works again. [David]

=back

=head1 VERSION 1.3.3

=head2 New Features

=over 4

=item *

Revised Bric::Biz::Keyword implementation to improve performance. The new
implementation no longer relies on the Bric::Util::Grp system. Also
implemented API and database support for Media keywords. [Sam]

=item *

Added support for search Media by category and file name through the SOAP
interface and standard API. [Sam]

=item *

Added new C<--save-cookie-file> and C<--use-cookie-file> options to
F<bric_soap> to allow authentication to span F<bric_soap> calls. This can
result in significant time savings across multiple invocations. [Matt]

=item *

Added new C<--chunks> option to the F<bric_soap> tool to avoid problems with
timeouts on large workloads. Currently only supports the workflow commands
(C<publish>, C<deploy>, C<checkin>, C<checkout>, C<move>), but it will be
expanded to other long-running commands in the future. [Sam]

=item *

Improved performance of search paging. ListManager now only builds the output
rows that will actually be shown on the screen. For large data sets this
results in a huge gain in search speed. [Adam and Sam]

=item *

Revised category implementation to use explicit C<uri> and C<parent_id> fields
rather than relying on the Bric::Util::Grp system. This improves performance
tremendously for larger numbers of categories. [Jeff Pinyan]

=item *

Added new C<--continue-on-errors> option to F<bric_soap> to prevent non-fatal
errors from ending the process. [Sam]

=item *

Beautified the list paging interface. [David]

=item *

Added new Media Type manager. [Scott]

=item *

Added list reverse feature. [Scott]

=item *

Added SFTP mover. [Scott]

=item *

Add support for Apache-SSL. This required a change to the context of the
F<bricolage.conf> C<ENABLE_SSL> directive to indicate the type of SSL support:
none, apache_ssl, or mod_ssl. [Michael Robinton]

=item *

Added support for manual httpd configuration. Split out dynamic configuration
from ApacheConfig.pm and move to a new module, ApacheStartup.pm, that sets no
Apache configuration directives. ApacheConfig.pm calls this module. [Michael
Robinton]

=item *

Added F<bricolage.conf> configuration directive to force the start up process
to always write out a F<C<$TEMP_DIR>/bricolage/bric_httpd.conf> as an
F<httpd.conf> include file. [Michael Robinton]

=item *

Moved SSL key and certificate configuration from global F<httpd.conf> settings
to per virtual host via F<bricolage.conf> configuration directives. [Michael
Robinton]

=item *

Added a C<bricolage.conf> directive to force the user to always use SSL.
[Michael Robinton]

=item *

Added C<get_data()> method to Bric::Util::Grp::Parts::Member::Contrib. This
method takes a simpler scalar argument and returns the relevant attribute.
This bit of syntactic sugar makes contributor objects behave a bit more like
C<$element> objects in templates, thus simplifying things for template
developers. [David]

=item *

Categories now default to sorting by URI, and the URI is the searchable field,
rather than name. [David]

=item *

Vastly improved the speed at which categories can be imported via SOAP.
[David]

=item *

Makefile now confirms location of Apache and PostgreSQL to allow for
systems with multiple versions of each available. [Sam]

=item *

Added "make clone" command to the installation system to create
distributions based on existing Bricolage systems.  [Sam]

=item *

Added F<bricolage.conf> directive to enable/disable the browser toolbar for
debugging and development. Documented in L<Bric::Hacker|Bric::Hacker>.
[Michael Robinton]

=item *

Added support for running Bricolage with SSL support on arbitrary ports.
Previous versions required https support to use only port 80 for http and port
443 for https. With this release, Bricolage fully supports http and https
service on any ports. This allows the Apache daemon supporting Bricolage to be
run with a minimum number of children while still allowing normal http and
https service on the standard ports with a light-weight Apache daemon. See the
F<INSTALL> file (or L<Bric::Admin|Bric::Admin>) for full details and an
example installation procedure. [Michael Robinton]

=item *

Added new F<bric_apachectl> command "single". This command will start
Bricolage in single-process mode. This mode is principally useful for
debugging. [Michael Robinton]

=item *

The size of the database column that stores custom field options (such as for
select lists) has been changed to the TEXT PostgreSQL type, so that the number
of options isn't arbitrarily limited. [Matt Vella]

=item *

The group API has been approximately 75% rewritten. The goal was to optimize
its performance, since group activity proved to be a serious bottleneck to
Bricolage performance. Those interested in the nitty-gritty details of the
rewrite can read about them here:
L<http://sourceforge.net/mailarchive/forum.php?thread_id=967943&forum_id=561>.

=back

=head2 Bug Fixes

=over 4

=item *

Added constraint to the group table to keep a group from having itself as a
parent. Thanks to JoE<atilde>o Pedro GonE<ccedil>alves for the patch. [David]

=item *

Fixed bug in side navigation where an HTML table was opened but not closed.
[Charles Albrecht]

=item *

Fixed bug where installation system would chown all of the chosen TEMP_DIR to
SYS_USER. Thanks to Dave Rolsky for the report. [Sam]

=item *

Fixed a bug in the installation system that was creating empty comp/comp and
data/data directories BRICOLAGE_ROOT. Thanks to Michael for the spot. [Sam]

=item *

Fixed remote previews to redirect to a better URL. [Mark]

=item *

Fixed a bug where trying to create a story through the SOAP interface
containing a contributor with an empty middle name would fail.  [Sam]

=item *

Changed strftime instances of '%G' to '%Y' in URI preference, as this seems to
be more portable. [David]

=item *

Fixed bug that was preventing 'make upgrade' from running database upgrade
scripts. [Sam]

=item *

Fixed broken "Log" link on Media Search results screen. [Sam]

=item *

Fixed bug where deleted output channels were showing up in list of available
output channels in the element profile. [David]

=item *

Fixed conflict in list manager that prevented some lists from working
properly. Probably never showed up before, as we only noticed it with the new
Media Type manager. Thanks to Scott for the heads-up. [David]

=item *

The C<PREVIEW_MASON> configuration directive no longer is no longer defaulting
to on in one context and off in another. It is now off by default. Thanks to
Michael Slattery for the spot! [David]

=item *

Eliminated the password field type from the formBuilder interface used for
contributor types and elements. Its inclusion up to now may be considered a
bug. [David]

=item *

Fixed cover date editing to repopulate correctly on the Story profile screens.
[Matt]

=item *

Fixed bug where previewing a story assigned to multiple categories would
preview to a random category. Now the primary category is always chosen. [Sam]

=item *

Fixed display and editing of dates more than one year in the past. [Matt]

=item *

Fixed bug where setting CHAR_SET to UTF-8 in bricolage.conf would result in
blank output. [Sam]

=item *

Changed Category manager to display no categories by default, only display
them after a search. This is because some folks have a I<lot> of categories.
[David]

=item *

Fixed bug where when C<SYS_USER> and/or C<SYS_GROUP> wasn't in
F<bricolage.conf>, Bric::Config would use the username "nobody" instead of the
UID for the user "nobody". [David]

=item *

Adding a note to a story that has not yet been saved no longer causes an
error. [David]

=item *

Fixed "make dist" to work on Mac OS/X and FreeBSD. [Sam]

=item *

Fixed a problem in Bric::Util::Burner::Template where a newly added
template wouldn't be picked up by <tmpl_include>.  This was due to
caching being turned on.  HTML::Template's cache doesn't know that a
new compilation would turn up a difference <tmpl_include> so it
continues to use the old one.  [Sam]

=item *

Fixed installer to not require unneeded Apache modules (mod_proxy and
mod_rewrite). [Sam]

=item *

Fixed installer to first ask whether SSL support is desired before asking for a
specific SSL module. [Sam]

=item *

Fixed documentation bug in Bric::Admin concerning PostgreSQL paths. Thanks to
Vicki Brown for the catch. [Sam]

=item *

Fixed installation system to fail if there are errors importing the database.
Also added test for missing or empty bricolage.sql. [Sam]

=item *

Fixed installation system to support optional modules and not force users to
install them. [Sam]

=item *

Fixed bug that prevented the contents of fields to be updated through
Bric::SOAP. [Sam]

=item *

Fixed "Checkin and Publish" button to only appear if the user has permissions
to publish. [Matt]

=item *

Fixed bug where text pasted into Bulk Edit textarea box was getting words
smooshed together. Thanks to Rachel Murray for the spot. [David]

=item *

Fixed bug where date field elements weren't getting properly converted between
the local time zone and UTC, which is the time zone of all the dates in the
database. Thanks to Matt Vella for the spot. [David]

=item *

Fixed issue where Bric::Util::Grp was adding every member of a group whenever
a new member was added. This was very wasteful, and slowed performance a great
deal for groups with thousands of members. Thanks to Mark for the spot.
[David]

=item *

Added check for Category "Directory" string to make sure that no non-URL
characters are added. [Matt Vella]

=item *

Clicking "Cancel" when editing keywords in a new story now properly returns to
the story profile, rather than to the last screen before the story was
created. [David]

=item *

Deleting a a contributor immediately after adding one no longer causes all of
the contributors to be deleted on check-in. [David]

=item *

Contributors are now properly reverted when stories and media are
reverted. [David]

=back

=head1 VERSION 1.3.2

=head2 New Features

=over 4

=item *

Added --chunks option to bric_republish to publish stories in batches.
This is useful to avoid timing out on long runs. [Sam]

=item *

Added [Check In / Publish] button to Story Profile to checkin and
publish in one step. [Matt]

=item *

Added needs_publish() method and associated published_version database
field to Bric::Biz::Asset.  This method is now used by the publisher
to determine if something needs republishing.  Added new graphics to
display this information on the desks.  [Matt]

=item *

Moved repeated publish and preview functionality into
Bric::Util::Burner.  Updated Mason code and Bric::SOAP::Workflow
accordingly.  [Matt]

=item *

Added C<DBI_PROFILE> bricolage.conf option and C<bric_dbprof> script
to allow profiling of Bricolage database performance.  [Sam]

=item *

Added C<bric_apachectl debug> command to run Bricolage under the Perl
debugger using Apache::DB.  [Sam]

=item *

Added checks to make sure Story and Media URIs are unique within the
system.  [Matt]

=item *

Added search paging preference to break search results into multiple
pages.  [Adam]

=item *

Added support for running Bricolage under Devel::Profiler with the new
PROFILE configuration option.  [Sam]

=item *

Added support for Apache::SizeLimit to keep Apache process size under
control.  [Adam]

=item *

Revised Bric::App::Cache to improve performance.  The new system is a
two-level cache with Cache:Mmap and Cache::Cache.  This results in a
2x speedup on some cache-sensitive operations.  [Sam]

=back

=head2 Bug Fixes

=over 4

=item *

Clicking "Add More" when editing contributor contacts now retains any changes
made to the contributor profile. This matches the functionality of the user
profile. Thanks to JoE<atilde>o Pedro GonE<ccedil>alves for the spot. [David]

=item *

Fixed bug in Bric::SOAP::Element where deleting an element or field
could cause SQL errors due to overflowing the name field. [Sam]

=item *

Removed Bric::SOAP::Element->delete(force => 1) which could cause data
corruption in existing stories.  Also removed dependent options in
bric_dev_sync (--delete-existing) and bric_soap (--force). [Sam]

=item *

Fixed bug in Bric::SOAP::Element where updating an element could cause
Stories using that element to lose track of their field data. [Sam]

=item *

Fixed bug in Bric::Util::Burner::Template where <tmpl_include>s caused
syntax errors. [Sam]

=item *

The Bric::Biz::Category class method get_attr() now returns attributes for
category ID 0 as well as all other categories. [JoE<atilde>o Pedro
GonE<ccedil>alves]

=item *

Fixed bug in DBI_DEBUG and DBI_CALL_TRACE options where non-prepared queries
(row_aref(), all_aref(), etc.) were not being logged. [Sam]

=item *

Fixed bug in Bric::Dist::Resource that was causing publish to run very
slowly by executing a bad database query. [Sam]

=item *

Related to the last item, fixed a bug in Bric::Util::Coll that would call
the href() method on a class and pass in undefined values as parameters.
This will happen if a collection is created for a new object that does not
yet have an ID. The fix thus prevents the "= NULL" SQL syntax, which always
matches nothing. The new syntax for constructing a collection has been
implemented across the API. [David]

=item *

Fixed bug where the root category wasn't able to be added to a category
group. Actually, this fixes a problem where any object with an id of 0
couldn't be added to a group. Thanks to Mark for the spot. [David]

=item *

Changed mover list to be sorted in alphabetical order in the Destination
profile. This has the benefit of forcing "FTP" to be listed before "File
System" -- Hurray for case-sensitive ordering! Thanks to Sam for the
complaint. [David]

=item *

The OS for a destination server now defaults to the OS of the server on
which Bricolage is installed instead of "Mac". Thanks to Sam for the spot.
[David]

=item *

Deleted destinations will now be dissociated from output channels when
they're deleted. This prevents stories from being published to deleted
destinations. Thanks to Mark for the heads-up. [David]

=item *

Fixed bug where attribute metadata wasn't getting deleted when it was
supposed to. [JoE<atilde>o Pedro GonE<ccedil>alves]

=item *

Fixed bug where some browsers submit an image button with a value stored in
the image button's name as well as in the name with ".x" and ".y" appended
to it. This caused callbacks to be triggered twice for a single field! I
noticed this with Mozilla on Mac OS X, and presume it would happen
elsewhere, too. [David]

=item *

Fixed bug in navigation bar HTML that caused the bar to disappear on
certain browsers. [Rachel Murray]

=item *

Fixed bug in Bric::SOAP where Bricolage exceptions resulted in an
uninformative "Application error" message. Now the full exception message is
displayed. [Sam]

=item *

Fixed installation to work under Debian Linux 3.0 (testing). Thanks to Mark
Jaroski for a helpful patch. [Sam]

=item *

Changed length of Bric::Dist::Job name attribute from 64 characters to 256.
This allows long asset names to be used. Also added code to Bric::Dist::Job
to ensure that the name property is truncated if it's longer than 256
characters. Thanks to Josh Cox for the spot. [David]

=item *

Fixed bug where dumber browsers would submit a new template without any
Element selected. Thanks to Michael Robinton for reporting the bug. [David]

=item *

All stories and media are now required to be associated with a category. For
stories, the primary category cannot be deleted. If you want to change the
primary category, add a new category, change it to the primary, and then
delete the old primary category. This fix prevents previews and publishes
from breaking on stories and media that had no categories. Thanks to Mark for
the heads-up. [David]

=item *

An overhaul of the burn system had regressed the Output Channel preview
functionality. I've put it back now. [Mark]

=item *

Fixed button JavaScript to work correctly in Mozilla. [Matt]

=item *

Fixed bug in HTML::Template burner that prevented <tmpl_include>s from
working in some cases.  [Sam]

=item *

Numerous spelling errors were fixed by Scott Lanning. Thanks!

=item *

In the Element manager, doing a search after selecting an Element Type from
which to display elements no longer causes an error. Thanks to Adam Robinson
for the spot. [David]

=item *

Made the parent category field in the Category Profile a required field.
[Mark]

=item *

Fix Bric::Util::FTP::FileHandle to work with a modified date-formatting
preference. [Matt]

=item *

Fixed section numbering in the Contributor Type profile. [Scott Lanning]

=back

=head1 VERSION 1.3.1

=head2 New Features

=over 4

=item *

Bricolage SOAP interface fully implemented.  The command-line clients
bric_soap, bric_dev_sync and bric_republish are all complete. [Sam]

=item *

Bricolage now comes with a configure script and a Makefile for easier
installation and configuration. [Mark Jaroski]

=item *

Removed MD5 Perl module requirement by requiring Apache::Session 1.54 or higher.
[David]

=item *

Added new FTP distribution move method. Now you can distribute files either via
a file system copy or via FTP. [David]

=item *

Added a preference to change the way URIs are formatted. [Adam]

=item *

Added a URI case preference to force URIs to lowercase, uppercase, or
allow mixed case URIs.  [Adam]

=item *

Categories are now all listed and sorted by URI in select lists. [Sam]

=item *

The cache is now cleared when the Apache server is started or
restarted.  This avoids potential problems with stale data in the
cache. [Sam]

=back

=head2 Bug Fixes

=over 4

=item *

Fixed numerous cases where user_ids were being used as booleans.
Since user_id 0 is the Administrator's user_id this can cause problems. [Sam]

=item *

Fixed problem where deleting an asset would fail with the "cannot
check-in non checked-out version" error. [Sam]

=item *

Fixed bug in HTML::Template burner when an element name had more than
one space in it. [Sam]

=item *

Fixed bug in database that prevented element names over 32 characters
from working properly. [Sam]

=item *

Fixed bug where trying to preview a story without a Preview
destination and PREVIEW_LOCAL off would result in a Mason error. [Sam]

=item *

Fixed bug in Bric::SOAP::Story->create() where data element order was
getting lost. Thanks to Mike Slattery for the spot. [Sam]

=item *

Fixed bug in HTML::Template burner where templates in non-root categories
could not be found. Thanks to Marlon Bermas for the spot. [Sam]

=item *

Fixed Bric::Util::FTP::FileHandle to create new revisions on PUT. [Sam]

=item *

Deleting a contributor will no longer break stories with which the contributor
is associated. Thanks to Rachel Murray for the spot. [David]

=item *

Invalid configuration directives in bricolage.conf will now be caught and keep
Bricolage from starting. [Sam]

=item *

The view button in the element profile now works correctly. Thanks to
JoE<atilde>o Pedro GonE<ccedil>alves for the spot. [David]

=item *

Changed all strftime instances of '%G' to '%Y', as this seems to be
more portable. [David]

=item *

Checking in a template from a template profile now performs a syntax check of
the template just as saving the template does. [JoE<atilde>o Pedro
GonE<ccedil>alves]

=item *

Notes attached to stories and media are now once again editable from
the desk and profile views if they're checked out to the current user,
and only viewable otherwise. Thanks to Tracey Largay for the
spot. [David]

=item *

Fixed a few poorly-named time zones in the time zone preference. More
still needs to be done here, actually. [David]

=item *

Implemented the chk_syntax() method in Bric::Util::Burner::Template.
[Sam]

=back

=head1 Version 1.2.3

Functionally equivalent to 1.2.2, but includes required files missing from the
1.2.2 distribution.

=head1 Version 1.2.2

=head2 New Features

=over 4

=item *

Added chk_syntax() methods to Bric::Util::Burner and its subclasses. This method
will takes a template asset object and make sure that it compiles.
Bric::Util::Burner::chk_syntax() delegates to the proper subclass.

=back

=head2 Bug Fixes

=over 4

=item *

Some misspellings were corrected in Bric::Admin. Thanks to Ask Bjoern Hansen for
the spot. [David]

=item *

Fixed broken "Return" buttons on related media and related story pages. [David]

=item *

Fixed bug where assets weren't activated when they were created and then checked
in without clicking the "Save" button. [David]

=item *

Fixed bug where a fixed story's slug was getting used in its URI. [David]

=item *

Fixed broken image autopopulation fields (compression, height, width, etc.)
[David]

=item *

Fixed broken support for audio and video files. These can be set up by the Media
Type menu in Element Types. Eventually these should arrange for some fields to
be auto-populated (e.g., bit rate, frame size, length, encoding, etc.). [David]

=item *

Fixed bug where Categories with the same directory name could not be created.
Thanks to Andrew Baio for the spot. [David]

=item *

Fixed a bug where a user couldn't look at her own event log if she didn't have
permission. Thank to Michael Alan Dorman for the spot. [David]

=item *

Fixed a bug where permissions set to access workflows and desks had no affect on
the display of workflows and desks. Thanks to Rachel Murray for the spot.
[David]

=item *

Fixed bug where attempting to create a destination with the same name as an
existing but deactivated destination triggered an SQL error. Thanks to Michael
Alan Dorman for the spot. [David]

=item *

Fixed bug where Workflows with spaces in their names would not create proper
submenus in the left navigation bar. Thanks to the WHO for the spot [David]

=item *

Fixed bug where the wrong story might be previewed when clicking the title of a
story in My Workspace or on a desk. [David]

=item *

Changing the category a media asset is in now correctly updates the underlying
category object and the URI without the media asset needing to be checked in.
[Matt Vella]

=item *

Eliminated "Template compile failed" errors for templates with <%init> sections.
[David]

=item *

Field elements now show up with their display names in the bulk edit select
lists, instead of with their names (which are really keys). [David]

=item *

Eliminated "Use of uninitialized value in bitwise or (|)" warnings when checking
permissions. Thanks to Sam Tregar for the spot. [David]

=item *

Custom fields in elements and contributor types now remember their "size"
setting. Thanks to Sam Tregar for the spot. [David]

=item *

The Element select list on the new Template profile no longer lists media
elements, since media assets don't use templates. [David]

=item *

Removed old XML::Writer stuff from Bric::Util::Burner, since I moved it to
Bric::Util::Burner::Mason a while ago and it was causing some problems. Thanks
to Michael Robinton for the spot. [David]

=item *

Fixed typo in Bric::Hacker spotted by Axel Beckert. [Sam]

=item *

The CREATE permission works properly now. Thanks to Rachel Murray for the spot.
[David]

=back

=head1 VERSION 1.2.1

=head2 New Features

=over 4

=item *

Created new method of configuring Bricolage in Apache. For mod_perl 1.26 and
earlier, a custom config file will be written to the bricolage temp directory
every time Bricolage is started or restarted. For mod_perl 1.27 and later, no
temp file will be written. [David]

=item *

Added support for Mozilla (and there was much rejoicing!). [David]

=item *

Changed password for the default "admin" user to "change me now!" [David]

=item *

The slug is stored in the database for both fixed and non-fixed stories. This is
in anticipation of adding the ability to use the slug for fixed story URIs later
on. Thanks to Darren Graves for the patch.

=item *

Added DISABLE_NAV_LAYER directive. It's off by default, but if you turn it on in
bricolage.conf, the side navigation layer will be rendered as plain HTML in
every page instead of as a separate layer. [David]

=item *

Documented PERL_LOADER directive in Bric::AdvTemplates. [David]

=back

=head2 Bug Fixes

=over 4

=item *

Turned off the PREVIEW_MASON configuration directive in bricolage.conf. It should
be off by default. [David]

=item *

Deleted Output Channels now properly don't show up in the Output Channel manager
again. Thanks to Sara for the spot! [David]

=item *

All previews now preview assets in the primary Output Channel only. Previously,
the previews were in the Output Channel whose name came first alphabetically.
Thanks to Sara Wood for catching this bug. [David]

=item *

Fixed bug where templates often couldn't be found by the Mason burner if the
output channel had a post_path. [David]

=item *

Fixed bug where templates often couldn't be found by the HTML::Template burner
if the output channel had a post_path. [Sam]

=item *

Fixed some problems with the sideNav menus under Netscape. [David]

=item *

Fixed broken "Preview" button in Read-only story profile and in related story
elements. [Matt Vella]

=item *

Updated debugging code to accommodate new syntax in Cache::Cache. Thanks to Sam
Tregar for the spot. [David]

=item *

Fixed problem with Element names containing non-alphanumeric characters. [Sam]

=item *

Checking out media assets from "Find Media" now redirects you to the media
profile if you've checked out one media asset, or My Workspace if you've checked
out more than one. This puts it in line with how "Find Stories" and "Find
Templates" work. Thanks to Sam for the report. [David]

=item *

Fixed bulk edit functionality for Media assets. Thanks to Sam for the spot.
[David]

=item *

In Bric::Biz::Asset::Business, the source get_meth key in my_meths() now works
properly. Also, get_all_keywords() now also returns the category keywords as
well as the story keywords. Thanks to Darren Graves for the patch.

=item *

Removed quotation marks from DEF_MEDIA_TYPE setting in bricolage.conf. Thanks to
Darren Graves for the spot. [David]

=item *

Sorting assets by ID in "Find X" and Workspace/Desk view now properly does a
numeric sort rather than an alphanumeric sort. Thanks to Sam Tregar for the
spot. [David]

=item *

Fixed an obscure bug where, for files uploaded as part of a Media file,
Bricolage attempted to create a path on its own file system using path
delimiters for another file system. Thanks to Mike Slattery for the spot.
[David]

=item *

Required content fields in stories and elements are now displayed in the order
specified in the Element profile. Thanks to Sam Tregar for the spot. [David]

=item *

All assets now start with the version number 0 until the first time they are
checked in. Also, they will show up on desks and in the Find views after the
first time they are saved. It was inconsistent before, and some items could not
be seen in the desk and Find views until they were checked in. Thanks to Sam for
spotting the inconsistency. [David]

=item *

The bric_clean_tmp script has been changed to avoid deleting the Bricolage
cache file.  [Sam]

=item *

Fixed typo that broke Bric::Dist::Client. [Mike Slattery]

=item *

Fixed multiple select custom fields for Elements and Contributors. Thanks to
Mike Slattery for the spot. [David]

=item *

Fixed ugly bug where deleting a "Media Type" Element would delete all the media
objects of that type. Thanks to Sam for the spot (though not for the bug!).
[David]

=item *

Fixed bric_pgimport so that it uses DBI to drop and create the database, rather
than relying on a hard-coded location for pgsql binaries. [David]

=item *

Fixed permission granting in bric_pgimport so that the Bricolage database use
has DELETE permissions on all objects in the Bricolage database. It looks like
this permission was ignored in PosgreSQL 7.1 and earlier, or problems would have
shown up a long time ago! [David]

=item *

Fixed a bug where the time a distribution job is scheduled was not properly
converted to UTC for storage in the database. Thanks to Mike Slattery for the
great code archaeology! [David]

=item *

Fixed the spelling of "contributor" in several spots. [Andrew Baio]

=item *

Fixed bug where changing a story's primary category left it with B<no> primary
category. [Matt Vella]

=back

=head1 VERSION 1.2.0

=head2 New Features

=over 4

=item *

Added Context-sensitive, online help. [Sam]

=item *

Added separate interface for editing templates (via FTP). [Sam]

=item *

Added the ability to use HTML::Template Templates. [Sam]

=item *

Added ability for different Output Channels to function as different component
roots for in Mason templates. This will allow for templates that can't be found
in the current Output Channel to be searched for in other Output Channels.
[David]

=item *

Added link to Event log to Find Story, Find Template, and Find Media screens.
[David]

=item *

Added true previewing for media assets. Now, when you click their URIs to
preview them, they will be distributed to the preview server(s) before
redirecting the user to them, rather than just serving them up from where they
live on the Bricolage file system. The latter can still be accessed under
"Download" in the Media Asset profile. This will continue to be the preferred
way to grab media files for editing and such, as it will not incur the overhead
of distributing the media file. [David]

=item *

Allow only one template with a given name for a given category, element, burner
and output channel. [Sam]

=item *

Added a Maintainer section to the About page. [David]

=item *

Updated About page to mimic the layout of the help pages. [David]

=back

=head2 Bug Fixes

=over 4

=item *

Fixed a bug with local previews where a preview page could show up instead of
the Bricolage UI. Thanks to Sara for the spot. [David]

=item *

Fixed a bug where Mason component calls failed in previews when the
PREVIEW_MASON directive was enabled. [David]

=item *

Changed default value for text area fields added via the form builder (i.e., in
Contributor Type and Element profiles) to 0. The values 0 and "" always make the
the new field unlimited in length. [David]

=item *

Fixed a couple of buttons to be proper case rather than upper case. [David]

=item *

Separated the filesystem destinations for assets burned for publication and for
assets burned for previewing. This will prevent someone previewing and stomping
all over a published version of an asset before the published version is
distributed. [David]

=item *

Removed hard-coding of the local preview directory in httpd.conf and
httpd-ssl.conf. Now using the values stored in PREVIEW_LOCAL, instead, to
determine the proper directory. [David]

=item *

Added the DEF_MEDIA_TYPE directive. Bricolage will use the value in this
directive to assign a Media Type to all file resources if Bricolage can't
figure it out from their file extensions. This fixes a bug where Bricolage would
choke if it couldn't figure out the MediaType itself. [David]

=back

=head1 VERSION 1.0.2

=head2 New Features

=over 4

=item *

Added "File Name" and "File Extension" properties to OutputChannels. These
properties will now be used to name files burned to the file system on
preview and publish. [David]

=item *

Added DEFAULT_FILENAME and DEFAULT_FILE_EXT configuration directives to set
default values on the "File Name" and "File Extension" Output Channel
properties. [David]

=item *

Changed Bric::Util::Burner->display_element() so that it doesn't paginate. All
paginated pages are now treated instead as regular elements. This is useful for
things like printer-friendly pages. Bric::Util::Burner->display_element()
continues to work as before. Use this method to output a separate file for each
paginated element. [David]

=item *

When errors occur while previewing stories, the leftNav is now turned off.
[David]

=item *

Browser buttons and menus are now disabled. [David]

=item *

Added ability to set permissions on assets based on the categories they're in.
[David]

=item *

Moved all session and session locking files into the "bricolage" subdirectory of
the local file system's tmp directory. You'll want to rm -rf /tmp/bricolage_*
upon upgrading. [David]

=item *

Moved the location of cache files to the "bricolage/cache" subdirectory of the
local file system's tmp directory. You'll want to rm -rf /tmp/FileCache upon
upgrading. Together with the above change, this means that all Bricolage
temporary files are stored in the "bricolage" subdirectory of the local tmp,
e.g., /tmp/bricolage. [David]

=item *

Added new program, bric_clean_tmp, that can be used in a cron job to delete
stale temporary files. [Sam]

=item *

Added an "About" page, linked from the logo graphic, that explains the name
"Bricolage" and offers the license and credits. [David]

=item *

Added PERL_LOADER configuration directive. Pass a line of Perl to this
directive, and on startup, it'll execute it in the same namespace as your
templates execute in. [David]

=item *

Added INCLUDE_XML_WRITER and XML_WRITER_ARGS configuration parameters. If
INCLUDE_XML_WRITER is turned on, then all templates will include a new global,
$writer, that is an XML::Writer object. This object is provided as a convenience
for creating XML in your templates. XML_WRITER_ARGS allows certain arguments to
be passed to the XML::Writer. [David]

=item *

Fixed bug where data fields deleted from Elements were deleting them from
existing stories, too. [David]

=item *

Fixed bug where stories with related media associated with them were displaying
the story as an Element rather than as a story after editing the related media.
[David]

=item *

Removed all file system location dependencies for the operation of Bricolage.
Bricolage will still assume that everything's in /usr/local/bricolage, but any
location is fine as long as the BRICOLAGE_ROOT environment variable is set to
the proper location. [David]

=item *

Added code to force all preview pages to be re-requested from the server every
time they're viewed. This prevents the browser from loading older versions from
its cache, and allows users to always see the most recently-burned output of a
story. [David]

=item *

Removed debugging information from URLs for when debugging is turned off --
which should be always in production code (e.g., releases). [David]

=item *

Elements are now displayed with their display names rather than their attribute
names. Thanks to Sam Tregar for the spot. [David]

=item *

Fixed bug where fields (attributes) added to an Element with the name of an
existing but deactivated field triggered an error. Thanks to Sam for the
heads-up. [David]

=item *

Fixed a bug where data fields sometimes were not properly retrieved from the
database in Bric::Biz::AssetType. [David]

=item *

Fixed a bug where clicking "Save and Stay" in the Element profile wouldn't
delete attributes (fields) marked as such, or even delete the Element itself, if
the "Delete this profile" checkbox was checked.

=item *

Fixed a bug where, for Story and Media assets, editors were given Edit access to
notes, even when they didn't have the asset checked out. [David]

=item *

Changed the misleading and inaccurate "Two blank lines" label in the Bulk Edit
interface to the more accurate "One blank line". Thanks to Sam Tregar for the
heads-up.

=back

=head1 VERSION 1.0.1

=over 4

=item *

Initial public release.

=back

=head1 AUTHOR

David Wheeler <david@wheeler.net>

=head1 SEE ALSO

L<Bric|Bric>

=cut
