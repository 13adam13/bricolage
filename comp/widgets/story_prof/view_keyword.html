<%perl>;
$m->comp("/widgets/wrappers/sharky/table_top.mc",
  	 caption =>  "Category Keywords");
$m->out("<table border=0 cellpadding=2 cellspacing=0 width=550>");
foreach my $cat ($story->get_categories) {
    $m->out(qq{<tr><td width=145 align="right"><span class="label">}.$lang->maketext('Category').'</span></td><td width=405>'
	    . qq{<span class=label>} . $cat->get_name
	    . "</span></td></tr>\n");
    my $flag = '<span class="label">Keywords</span>';
    foreach my $kw ($cat->get_keywords) {
        $m->out(qq{<tr><td width=145 align="right">$flag</td><td width=405>}
		. $kw->get_name . "</td></tr>\n");
        $flag = '&nbsp;';
    }
}
$m->out("</table>");
$m->comp("/widgets/wrappers/sharky/table_bottom.mc");

# Output the keywords.
$m->comp("/widgets/wrappers/sharky/table_top.mc",
  	 caption => "Story Keywords");
$m->out("<table border=0 cellpadding=2 cellspacing=0 width=550>");
foreach my $kw (@$keywords) {
        $m->out(qq{<tr><td width=145 align="right">&nbsp;</td><td width=405>}
		. $kw->get_name . "</td></tr>\n");
}
$m->out("</table>");
$m->comp("/widgets/wrappers/sharky/table_bottom.mc");

# Output the save buttons.
$m->comp('/widgets/profile/formButtons.mc', type => 'story', section => 'workflow',
	 no_del => 1, widget => $widget, cb => 'add_kw_cb', no_save => 1);
</%perl>

<%args>
$widget
$param => undef
</%args>

<%init>;
my $story = get_state_data($widget, 'story');
my $keywords = $story->get_keywords || [];
</%init>
