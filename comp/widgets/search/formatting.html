%#--- Arguments ---#

<%args>
$widget
$object
$disp_field
$use_form_tag
</%args>

%#--- Initialization ---#
<%init>
my $agent = detect_agent();
my $spacerRow = $agent->ie ? '<img src="/media/images/spacer.gif" width=550 height=3>' : "";

my $advanced_search = get_state_data($widget, 'advanced_search')
  || get_pref('Default Search');
</%init>

% if ($use_form_tag) {
<form action="<% $r->uri %>" method="post">
% }

<%perl>
my $caption;
unless ($advanced_search) {
    $caption = sprintf(qq{%s ~[<a href="%s?%s|set_advanced_cb=1" class="switchSearch">%s</a>~]},
                   $lang->maketext('Search'),
                   $r->uri,
                   $widget,
                   $lang->maketext('Advanced Search'));
} else {
    $caption = sprintf(qq{%s ~[<a href="%s?%s|unset_advanced_cb=1" class="switchSearch">%s</a>~]},
                   $lang->maketext('Advanced Search'),
                   $r->uri,
                   $widget,
                   $lang->maketext('Simple Search'));
}
$m->comp("/widgets/wrappers/sharky/table_top.mc",
              caption => $caption,
              search  => 1);
</%perl>
<table border=0 cellpadding=0 cellspacing=0 width=580>
<tr>
  <td class=darkHeader><img src="/media/images/spacer.gif" width=1 height=1></td>
  <td class=lightHeader>
<% $spacerRow %>
            <table>
% unless ($advanced_search) {
              <tr>
                <td>
                  <& /widgets/profile/text.mc, 
                     name     => $widget.'|simple',
                     value    => get_state_data($widget, 'simple') || '',
                     useTable => 0 &>
                </td>
                <td>
%# This hidden field is required to make the form submit when the user hits
%# the "enter" key.
                  <input type="hidden" name="<% $widget %>|formatting_cb" value="Search" />
                  <input type="image" src="/media/images/<% $lang_key %>/search_red.gif" border=0 name="<% $widget %>|formatting_cb" value="Search">
                </td>
% } else {
              <tr>
                <td align=right><span class=label><%$lang->maketext('Name')%>:</span></td>
                <td>
                  <& /widgets/profile/text.mc, 
                     name     => $widget.'|name',
                     value    => get_state_data($widget, 'name') || '',
                     useTable => 0 &>
                </td>
              </tr>             
              <tr>
                <td align=right><span class=label><%$lang->maketext('File Name')%>:</span></td>
                <td>
                  <& /widgets/profile/text.mc, 
                     name     => $widget.'|file_name',
                     value    => get_state_data($widget, 'file_name') || '',
                     useTable => 0 &>
                </td>
              </tr>
              <tr>
                <td colspan=2><span class=label><% $lang->maketext('Cover Date') %></span><br />
                  <% $lang->maketext('From') %>:
                  <& '/widgets/select_time/select_time.mc', 
                     base_name  => "$widget|cover_date_start",
                     indent     => 1,
                     no_hour    => 1,
                     no_min     => 1,
                     repopulate => 0,
                     def_date   => get_state_data($widget, 'cover_date_start')||'',,
                     compact    => 1,
                     style      => 'inline',
                  &>
                  <% $lang->maketext('To') %>:
                  <& '/widgets/select_time/select_time.mc', 
                     base_name  => "$widget|cover_date_end",
                     indent     => 1,
                     no_hour    => 1,
                     no_min     => 1,
                     repopulate => 0,
                     def_date   => get_state_data($widget, 'cover_date_end')||'',,
                     compact    => 1,
                     style      => 'inline',
                  &>
                </td>
              </tr>
              <tr>
                <td colspan=2><span class=label><% $lang->maketext('Publish Date') %></span><br />
                  <% $lang->maketext('From') %>:
                  <& '/widgets/select_time/select_time.mc', 
                     base_name  => "$widget|publish_date_start",
                     indent     => 1,
                     no_hour    => 1,
                     no_min     => 1,
                     repopulate => 0,
                     def_date   => get_state_data($widget, 'publish_date_start')||'',,
                     compact    => 1,
                     style      => 'inline',
                  &>
                  <% $lang->maketext('To') %>:
                  <& '/widgets/select_time/select_time.mc', 
                     base_name  => "$widget|publish_date_end",
                     indent     => 1,
                     no_hour    => 1,
                     no_min     => 1,
                     repopulate => 0,
                     def_date   => get_state_data($widget, 'publish_date_end')||'',,
                     compact    => 1,
                     style      => 'inline',
                  &>
                </td>
              </tr>
              <tr>
                <td colspan=2><span class=label><% $lang->maketext('Expire Date') %></span><br />
                  <% $lang->maketext('From') %>:
                  <& '/widgets/select_time/select_time.mc', 
                     base_name  => "$widget|expire_date_start",
                     indent     => 1,
                     no_hour    => 1,
                     no_min     => 1,
                     repopulate => 0,
                     def_date   => get_state_data($widget, 'expire_date_start')||'',,
                     compact    => 1,
                     style      => 'inline',
                  &>
                  <% $lang->maketext('To') %>:
                  <& '/widgets/select_time/select_time.mc', 
                     base_name  => "$widget|expire_date_end",
                     indent     => 1,
                     no_hour    => 1,
                     no_min     => 1,
                     repopulate => 0,
                     def_date   => get_state_data($widget, 'expire_date_end')||'',,
                     compact    => 1,
                     style      => 'inline',
                  &>
                </td>
              </tr>
% }
            </table>
  </td>
  <td class=darkHeader><img src="/media/images/spacer.gif" width=1 height=1></td>
</tr>
<tr>
  <td class=darkHeader width=580 colspan=2><img src="/media/images/spacer.gif" width=580 height=1></td>
</tr>
</table>
<& '/widgets/wrappers/sharky/table_bottom.mc' &>

% if ($advanced_search) {
<p></p>
<input type="image" src="/media/images/<% $lang_key %>/search_lgreen.gif" border=0 name="<% $widget %>|formatting_cb" value="Search">
<input type="image" src="/media/images/<% $lang_key %>/clear_values_lgreen.gif" border=0 name="<% $widget %>|clear_cb" value="Clear Values">
% }
%#--- Log History ---#
% if ($use_form_tag) {
</form>
% }

