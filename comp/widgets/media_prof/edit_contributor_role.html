<form action="<% $r->uri %>" method="post">
<%perl>;
$m->comp('/widgets/wrappers/table_top.mc',
	 caption => "Select a Role");

$m->comp('/widgets/profile/select.mc',
	 disp => "Role",
	 name => "$widget|role",
	 value => $media->get_contributor_role($contrib) || 'DEFAULT',
	 options => $opt);

$m->comp('/widgets/wrappers/table_bottom.mc');
$m->comp('/widgets/profile/formButtons.mc',
	 cb => 'assoc_contrib_role_cb',
	 widget => $widget,
	 no_ret => 1,
	 no_del => 1,
	 type => 'story',
	 section => 'workflow',
	 val => 'next_dkgreen');
</%perl>

<%args>
$widget
</%args>

<%init>
my $contrib = get_state_data($widget, 'contrib');
my $media = get_state_data($widget, 'media');
my $opt = [];
foreach my $r ($contrib->get_roles) {
    $r eq '_MEMBER_SUBSYS' ? unshift @$opt, ['DEFAULT', 'Default']
      : push @$opt, [$r, $r];
}
</%init>
