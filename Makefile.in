# settings
SHELL = /bin/sh

# Programatic dependancies
PERL = @PERL@
APACHE = @APACHE@
POSTGRESHOME = @PGHOME@
POD2HTML = @POD2HTML@
POD2TEXT = @POD2TEXT@
POD2MAN = @POD2MAN@
GZIP = @GZIP@
MKDIR = @MKDIR@
FIND = @FIND@
CTAGS = @CTAGS@

# directories
BIN = bin
COMP = comp
CONF = conf
DATA = data
LIB = lib
DOC = doc

# Installation related variables
prefix  = @prefix@
exec_prefix  = @exec_prefix@
bindir  = @bindir@
datadir  = @datadir@
sysconfdir  = @sysconfdir@
libdir  = @libdir@
libexecdir  = @libexecdir@
includedir  = @includedir@
oldincludedir  = @oldincludedir@
mandir  = @mandir@
infodir  = @infodir@
sbindir  = @sbindir@
localstatedir  = @localstatedir@
sharedstatedir  = @sharedstatedir@

# Bricolage configuration info
APACHE_USER = @APACHE_USER@
APACHE_GROUP = @APACHE_GROUP@

# A list of any missing modules
MISSING_MODULES = @MISSING_MOD@
MODULE_COMMAND = $(foreach mod,${MISSING_MODULES},${PERL} -MCPAN -e "install ${mod}" ;)



all:  doc



install: dep 

dep: cpan

cpan:
	${INSTALL_MISSING}
	echo Installed ${MISSING_MODULES} >>install.log



doc: README INSTALL TODO License
	cd ${DOC} && ${MAKE} -e

INSTALL:
	${POD2TEXT} lib/Bric/Admin.pod >$@

TODO:
	${POD2TEXT} lib/Bric/ToDo.pod >$@

README:
	${POD2TEXT} lib/Bric/Changes.pod >$@

License:
	${POD2TEXT} lib/Bric/License.pod >$@


# TODO: Make this recursive
tags:
ifdef CTAGS
	${CTAGS} -R
endif


clean: docclean
	${RM} -f README INSTALL TODO License tags

docclean:
	cd $(DOC) && ${MAKE} -e clean


.PHONY : clean dep clean cpan doc
